# Вкладка: Действие

<figure><img src="../../../.gitbook/assets/Снимок экрана 2025-04-18 в 11.13.43.png" alt="" width="563"><figcaption></figcaption></figure>

### Поле: Добавить действие

Данное поле представляет собой выпадающий список из действий, которые можно настроить в блоке.&#x20;

#### Добавление действия:

Чтобы добавить действие в блоке, нажмите  "+ Добавить действие". &#x20;

<figure><img src="../../../.gitbook/assets/Снимок экрана 2025-04-18 в 11.17.04.png" alt="" width="563"><figcaption></figcaption></figure>

По умолчанию: тип действия - Действие:  никакое действие не выбрано.

<figure><img src="../../../.gitbook/assets/Снимок экрана 2025-04-18 в 11.15.17.png" alt="" width="563"><figcaption></figcaption></figure>

Можно добавлять несколько действий:

<figure><img src="../../../.gitbook/assets/Снимок экрана 2025-04-18 в 11.41.15.png" alt="" width="563"><figcaption></figcaption></figure>

### Действие: Переместить по воронке

Можно выбрать в какое [состояние воронки продаж в Salebot CRM](https://docs.salebot.pro/crm/salebotcrm) будет помещен клиент при переходе в данный блок. Удобно не только для продвижения клиента по этапам воронки, но и для наглядной сегментации клиентов по категориям. Например, заявки от частных лиц в одну колонку, а от организаций - в другую колонку SalebotCRM.

<figure><img src="../../../.gitbook/assets/Снимок экрана 2025-04-18 в 11.18.11.png" alt="" width="563"><figcaption></figcaption></figure>

### Действие: Добавить в список / Удалить из списка / Переместить в список

Можно добавлять клиентов [в списки](https://docs.salebot.pro/rassylki-1/spiski-podpischikov). Списки используют не только для сегментации базы, но и для настройки минимальной аналитики по спискам.&#x20;

<div><figure><img src="../../../.gitbook/assets/Снимок экрана 2025-04-18 в 11.19.09.png" alt=""><figcaption></figcaption></figure> <figure><img src="../../../.gitbook/assets/Снимок экрана 2025-04-18 в 11.19.19.png" alt=""><figcaption></figcaption></figure> <figure><img src="../../../.gitbook/assets/Снимок экрана 2025-04-18 в 11.22.15.png" alt=""><figcaption></figcaption></figure></div>

Действие "Переместить в список" предполагает, что пользователь будет удален из списка А и перемещен в список Б.

Создать новый список и выполнять другие действия с ними можно в разделе Списки (левое меню конструктора).&#x20;

После перехода клиента в блок с настроенными действиями, у клиента изменятся списки в которые он добавлен. \
В разделе Клиенты можно будет настраивать фильтрацию клиентов по спискам, а в диалоге с клиентом в правом меню отображаются списки, в которые данный клиент добавлен.

Увидеть список, в котором состоит клиент, можно в разделе "Клиенты" в карточке клиента:

<figure><img src="../../../.gitbook/assets/Снимок экрана 2025-04-18 в 11.27.50.png" alt="" width="375"><figcaption></figcaption></figure>

### Действие: Добавить метку / Удалить метку

Метки упрощают сегментацию клиентов и помогают визуально ориентироваться в диалогах в разделе Клиенты. Также как и списки, можно использовать для фильтрации клиентов.

<div><figure><img src="../../../.gitbook/assets/Снимок экрана 2025-04-18 в 11.21.16.png" alt=""><figcaption></figcaption></figure> <figure><img src="../../../.gitbook/assets/Снимок экрана 2025-04-18 в 11.21.29.png" alt=""><figcaption></figcaption></figure></div>

Создавать метки и управлять ими можно в разделе Списки - вкладка Метки. После перехода в блок с действием "Добавление метки" данная метка отобразится в диалоге с клиентом.

<figure><img src="../../../.gitbook/assets/Снимок экрана 2025-04-18 в 11.31.40.png" alt="" width="563"><figcaption><p>Пример использования меток для сегментации клиентов</p></figcaption></figure>

### Действие: Выполнить код на python

<figure><img src="../../../.gitbook/assets/Снимок экрана 2024-08-05 в 14.56.47.png" alt="" width="375"><figcaption></figcaption></figure>

До входа в блок, в котором будет использовано действие для выполнения кода на python, нужно назначить переменные, используемые в python скрипте. Все переменные, которые доступны в калькуляторе, будут доступны в скрипте: они будут переданы в словарь data, заранее его создавать не нужно.

<figure><img src="../../../.gitbook/assets/Снимок экрана 2024-08-05 в 15.00.57.png" alt=""><figcaption></figcaption></figure>

Пример:

В блоке "Первостепенной проверки условия" назначены переменные first и second.

<figure><img src="../../../.gitbook/assets/2024-08-05 15.03.03.jpg" alt="" width="563"><figcaption></figcaption></figure>

Далее во втором блоке устанавливаем действие "Выполнить код на Python":&#x20;

<figure><img src="../../../.gitbook/assets/2024-08-05 15.03.08.jpg" alt=""><figcaption></figcaption></figure>

В коде python обращаемся к этим переменным по ключу в словаре data, совпадающим с наименованием переменной из первого блока (создание переменной a), либо можно обратиться к переменной так же, как в выводе текста (создание переменной b).

{% hint style="info" %}
Обращаем внимание на создание переменной b - перед выполнением скрипта, все переменные, имеющие вид #{name\_variable}, заменяются значениями соответствующих переменных, как при отправке сообщения клиенту.
{% endhint %}

<figure><img src="../../../.gitbook/assets/2024-08-05 15.05.36.png" alt=""><figcaption></figcaption></figure>

В конце скрипта, как результат работы скрипта, возвращается переменная result, содержащая **{'**<mark style="color:red;">**a**</mark>**': a, '**<mark style="color:red;">**b**</mark>**': b, '**<mark style="color:red;">**sum\_ab**</mark>**': sum\_ab}.** Возвращать данные нужно именно в таком формате, тогда запишутся новые переменные, наименованием которых будут ключи возвращаемого словаря, а значениями переменных - соответствующие значения в словаре.&#x20;

Отработка ботом блоков с выполняемым скриптом на Python:

<figure><img src="../../../.gitbook/assets/2024-08-05 15.03.12.jpg" alt=""><figcaption></figcaption></figure>

#### Ошибки

Не удалось скачать файл - ошибка, из-за которой сохраненный файл с кодом не скачался для выполнения при отправке сообщения

result is not dict - возвращаемое значение должно быть словарем в формате ключ - значение, как на на примере ниже:

<figure><img src="../../../.gitbook/assets/2024-08-05 15.22.21.jpg" alt=""><figcaption></figcaption></figure>
