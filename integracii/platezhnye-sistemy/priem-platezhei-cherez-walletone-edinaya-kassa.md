---
description: >-
  Если Вам необходимо принимать международные платежи, Единая касса вам в этом
  поможет.
hidden: true
---

# WalletOne(Единая касса)

* [Как настроить WalletOne ](priem-platezhei-cherez-walletone-edinaya-kassa.md#nastroika-walletone)
* [Как настроить Salebot](priem-platezhei-cherez-walletone-edinaya-kassa.md#nastroika-salebot)
* [Пример](priem-platezhei-cherez-walletone-edinaya-kassa.md#primer)

## Как настроить WalletOne

Для подключения walletone Вам потребуются **id магазина** и **секретный ключ**. \
id магазина можно найти в правом верхнем углу вашего аккаунта:



![](https://lh4.googleusercontent.com/9r8LmZqqvfXfcJi3Qk07BOc-l6JdcvSysPqEFH1o0sidFYPHMehC03jB5O6gzV_ORcRHMIHLxuL595EU3UeSild95lJgGd6dLubgse50s20R0aaW5w7hFANB_qBSSmv0KyNH8hpz)

Для того чтобы бот получал уведомления об оплате, также необходимо установить в личном кабинете Единой кассы в разделе «Настройки», во вкладке «Интеграция» заполнить поле: Данные для отправки результата транзакции:\
[https://chatter.salebot.pro/walletone\_callback/result](https://chatter.salebot.pro/walletone_callback/result)\
и сгенерировать «секретный ключ», как показано на рисунке:

![](https://lh3.googleusercontent.com/9oGZr1ysfYy1BbLAsNITJvanXRzGD43RkbyK2j3yZF8FfgWmqcDeRsrSjfSjV29JHWD8oDjQjC3YH6buHbasfZm9NDioIRUNBFNgDE_f5UVHQWC7xN-kmkOzFiWPk3JbcxEctdJa)

{% hint style="info" %}
После генерации секретного ключа обязательно нажмите кнопку «Сохранить» внизу страницы. Это необходимое условие для корректной работы.
{% endhint %}

_Подробнее об условиях работы можно прочитать на сайте_ [_https://www.walletone.com/_](https://www.walletone.com/)

## Как настроить Salebot

### Как подключить

Для подключения wallenone необходимо перейти в раздел  "Эквайринг":



Далее необходимо просто указать данные, о которых говорили выше в форму.

![](/broken/files/sACciDr3eqtvMmeLFeS9)

На этом подключение закончено. Теперь давайте разберемся как использовать данный функционал.

#### **Указание суммы**

Для генерации ссылки на оплату вам необходимо установить значение переменной **payment\_sum**, сразу после этого появится переменная **walletone\_pay\_url.** Эту переменную можно вывести на экран ссылкой или разместить на кнопке с текстом "Оплатить". Ссылка имеет вид: **https://wl.walletone.com/checkout/checkout/Index?i=355956321993\&m=126335067885**

#### **Указание валюты**

Walletone принимает платежи в нескольких валютах, по умолчанию платеж создается в рублях. Для указания другой валюты вам необходимо присвоить значение переменной **currency.** Переменная принимает значения: **UAH RUB BYN USD TJS KZT EUR PLN ZAR**

Например, как на скрине ниже, чтобы указать валюту гривны, можно установить эту переменную в настройках проекта.

![](/broken/files/-M60SA5UXPguTK6bFGg1)

#### **Описание платежа**

Вы можете добавить описание платежа - оно будет отображаться в заголовке формы оплаты.

![](https://lh5.googleusercontent.com/hCNgbPajmALxNjNlPYBYyi-vbYs0rYwm0dN-WbdKSUVls37XVtqyS3lNd3vbbclE8cZs2VXKscRnIjPDQ_hzjLYaOwa6pWXD1JgqkVDBi8752FsRilLA70hhxMogICfdcLUSPsJ2)

Описание берется из переменной **payment\_description**

{% hint style="danger" %}
Описание должно быть только на латинице!
{% endhint %}

#### **Обработка результата**

{% hint style="info" %}
После успешной или неуспешной оплаты в бот придут колбэки, по которым вы сможете понять, что была успешная оплата. Эти колбэки в системе вы видите как сообщения от пользователя. Чтобы их не мог отправить пользователь, они состоят из ключа walletone и приписки со статусом, например: **793638786d31756066695c5a7b426739684e4e7449323344484353\_success** или **793638786d31756066695c5a7b426739684e4e7449323344484353\_fail**. Также после успешной оплаты переменная **walletone\_payment\_completed** устанавливается в **True.**\
\
Эти колбэки НЕ ВИДИТ пользователь, они отображаются только оператору
{% endhint %}

{% hint style="danger" %}
Тип сравнения должен быть "**Полное совпадение**"
{% endhint %}

{% hint style="warning" %}
Для совершения повторного платежа обязательно необходимо обнулить payment\_sum, ранее сформированную ссылку и уже после переназначить переменную payment\_sum для получения свежей ссылки
{% endhint %}

После завершения оплаты клиенту добавится переменная **walletone\_callback\_data**, содержащая данные ответа платежной системы по совершенной операции. Из полученного словаря можно извлечь необходимые данные при помощи метода **get**.

### **Пример**

Пример схемы, которая позволит протестировать быстро начать работу с Walletone.

![](/broken/files/1JPmrn0wZLjaZMenzxNi)

На рисунке показан пример первого блока, в котором пользователя спрашивают сколько он хочет оплатить.

Ниже настройки стрелки, в ней должен быть включен переключатель "Пользователь вводит данные" и в поле вписана переменная **payment\_sum.**

<figure><img src="/broken/files/QujgzbgucI1lYaDhllFe" alt="" width="497"><figcaption></figcaption></figure>

Обратите внимание, переменная #{walletone\_pay\_url} вставляется в разделе "Настройка вложений".

<figure><img src="/broken/files/YiagMtO8Uuk5KW4uFf2v" alt="" width="563"><figcaption></figcaption></figure>

Далее можно сделать развилку на два блока (или создать зеленые блоки с условиями). В одной стрелке в условии прописываем **qxgZ7zkNX4HHnG8UpZ61\_success -** колбек об успешной оплате, во второй: **qxgZ7zkNX4HHnG8UpZ61\_fail -** колбек о не успешной оплате.

{% hint style="info" %}
Тип проверки обязательно поставьте "Полное совпадение", иначе условия будут срабатывать на оба колбека.
{% endhint %}
