---
description: >-
  В статье расскажем, как подключить платежную систему Paykeeper в Salebot, и
  научим, как генерировать для нее ссылки на оплату.
---

# Paykeeper

<figure><img src="../.gitbook/assets/Снимок экрана 2025-04-09 в 17.12.26.png" alt="" width="252"><figcaption><p>Рис. 1. Кнопка подключения сервиса</p></figcaption></figure>

Для подключения к платежной системе paykeeper нужны следующие данные:

1. Логин и пароль для входа в учетную запись (можете создать отдельного пользователя, но не забудьте выдать ему необходимые права),&#x20;
2. ссылка на домен, через который выполняется вход в учетную запись (имеет вид [https://demo.paykeeper.ru](https://demo.paykeeper.ru), вместо demo будет что-то свое)&#x20;
3. ключ для верификации платежей.

Перейдите в раздел "Платежные системы" в проекте, найдите платежную систему PayKeeper и кликните на "Подключить":

<figure><img src="../.gitbook/assets/Снимок экрана 2025-07-01 в 14.50.31.png" alt=""><figcaption><p>Рис. 2. Подключение платежной системы в разделе "Эквайринг" в Сейлботе</p></figcaption></figure>

Введите необходимые данные в настройках подключения:

<figure><img src="../.gitbook/assets/Снимок экрана 2025-04-09 в 17.25.42.png" alt=""><figcaption><p>Рис. 3. Настройки подключения</p></figcaption></figure>

## Генерация ключа для верификации платежей

Ключ для верификации платежей генерируется при настройке вебхука. Для этого перейдите в личный кабинет Paykeeper.

<figure><img src="../.gitbook/assets/Снимок экрана 2025-04-09 в 17.09.11.png" alt=""><figcaption><p>Рис. 4. Переход в настройки платежной системы</p></figcaption></figure>

После входа в личный кабинет перейдите в настройки. Выберите пункт '**Получение информации о платежах**'.&#x20;

<figure><img src="../.gitbook/assets/Снимок экрана 2025-04-09 в 17.06.00.png" alt=""><figcaption><p>Рис. 5. Переход в раздел "Получение информации о платежах"</p></figcaption></figure>

В пункте '**Способ получения уведомления о платежа**х' выберите POST-оповещения.

Далее укажите url для вебхуков: [https://chatter.salebot.pro/paykeeper\_callback/result](https://chatter.salebot.pro/paykeeper_callback/result)

<figure><img src="../.gitbook/assets/Снимок экрана 2025-04-09 в 17.06.47.png" alt=""><figcaption><p>Рис. 6. Указываем url вебхуков и способ получения уведомления</p></figcaption></figure>

После этого нажмите кнопку "Сгенерировать". Появится секретное слово, что необходимо для получения вебхуков.

### Генерация ссылки платежа

После подключения платежной системы можете сгенерировать ссылку на платеж, для этого есть 2 способа:

1. через объявление переменной payment\_sum.&#x20;

В переменной payment\_sum указываем сумму платежа, если нужно использовать почту клиента, то до объявления payment\_sum нужно объявить переменную paykeeper\_email.

Аналогично нужно действовать с остальными параметрами:

<table><thead><tr><th width="308">Параметры</th><th>Значение</th></tr></thead><tbody><tr><td>paykeeper_service_name </td><td>эта переменная объявляется для передачи названия товара</td></tr><tr><td>paykeeper_client_name</td><td>эта переменная объявляется для передачи фио клиента</td></tr><tr><td>paykeeper_phone</td><td>эта переменная объявляется для передачи телефона клиента</td></tr></tbody></table>

2. С помощью функции paykeeper\_generate\_payment\_url, которая имеет следующие параметры:

<table><thead><tr><th width="324">Параметры</th><th>Значение</th></tr></thead><tbody><tr><td>amount</td><td>(обязательный параметр) сумма платежа</td></tr><tr><td>service_name</td><td>(необязательная параметр) название товара, </td></tr><tr><td>client_name</td><td>(необязательная параметр) фио клиента,</td></tr><tr><td>email</td><td>(необязательная параметр) mail клиента,</td></tr><tr><td>phone</td><td>(необязательная параметр) телефон клиента.</td></tr></tbody></table>

В первом случае сгенерируется ссылка с сохранением в переменную paykeeper\_pay\_url.

Во втором - ссылку возвращает функция.&#x20;

{% hint style="success" %}
Важно!  Для второго способа не забудьте результат выполнения функции поместить в переменную.
{% endhint %}

После успешной оплаты будет возвращен callback вида xxxxxx\_success 101.00, где:

1. &#x20;xxxxxx - это первые 6 символов секретного ключа,&#x20;
2. а вместо 101.00 будет сумма платежа.

Чтобы настроить реакцию на колбек (успешный платеж), укажите колбек в условии:

Можно указать в условии блока "Стартовое условие":

<figure><img src="../.gitbook/assets/Снимок экрана 2025-07-01 в 14.54.01.png" alt=""><figcaption><p>Рис. 7. Реакция на успешную оплату: прописываем колбек в условии блока "Стартовое условие"</p></figcaption></figure>

Также колбек можно указать в условии блока "Не состояние с условием":

<figure><img src="../.gitbook/assets/Снимок экрана 2025-07-01 в 14.54.21.png" alt=""><figcaption><p>Рис. 8. Реакция на успешную оплату: прописываем колбек в условии блока "Не состояние с условием"</p></figcaption></figure>

{% hint style="info" %}
Если вы не хотите выбивать клиента из основной схемы чат-бота, воспользуйтесь блоком "Не состояние с условием" — в этот блок нельзя перейти, поэтому клиента после оплаты не выбьет из основной воронки и при этом он получит уведомление об успешной оплате.



А если вам нужно продолжить воронку с реакции на успешную оплату, то используйте блок "Стартовое условие", тогда клиент из блока оплаты перейдет в блок "Стартовое условие", с которого вы можете продолжить воронку.
{% endhint %}

{% hint style="info" %}
Подробнее о [блоках с условием рассказали](/broken/pages/VktePfPMzzJlbjBSqE93) в одноименной статье.
{% endhint %}
